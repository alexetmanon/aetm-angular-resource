!function(){"use strict";angular.module("aetm-resource",["ngResource","angular-cache","aetm-network"]).factory("aetmHttpBuffer",["$http",function(e){return function(){function r(r,t){return e(r).then(t.resolve,t.reject)}var t=[];return{append:function(e,r){t.push({config:e,deferred:r})},retryAll:function(){var e,n=t.length;for(e=0;n>e;e+=1)r(t[e].config,t[e].deferred);t=[]}}}}]).factory("aetmResource",["$resource","CacheFactory","aetmHttpBuffer","aetmNetworkService","$rootScope","$q",function(e,r,t,n,o,c){function a(e,r){if(n.isOffline()){var t=c.defer();return t.promise.then(null,null,angular.noop),t.notify({status:"offline"}),r.append(e.config,t),t.promise}return c.reject(e)}function u(e,r,t){var n,o,c;c={responseError:function(e){return a(e,t)}},o={get:{method:"GET",cache:r},query:{method:"GET",isArray:!0,cache:r},save:{method:"POST",interceptor:c},remove:{method:"DELETE",interceptor:c},"delete":{method:"DELETE",interceptor:c},create:{method:"POST",interceptor:c},update:{method:"PUT",interceptor:c}};for(n in e)e.hasOwnProperty(n)&&e[n].cache===!0&&(e[n].cache=r);return angular.merge({},o,e)}return function(n,c,a,i){var f,l,h,d;return l=i.cacheId,h=r.get(l),h||(h=r.createCache(l,{storageMode:"localStorage"})),d=t(),o.$on("aetm-network:online",function(){d.retryAll()}),f=e(n,c,u(a,h,d),i),f.invalidateCache=function(){h.removeAll()},f.getCache=function(){return h},f}}])}();